{
    "model_params": {
        "name": "layered",
        "params": {
            "input_embedding_dim": 32,
            "output_embedding_dim": 4096,
            "layers": [
                [ "conv", { "in_channels": 32, "out_channels": 128, "kernel_size": 5} ],
                [ "mean_pool", { "kernel_size": 4, "stride": 4 } ],
                [ "layer_norm", { "normalized_shape": 128 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 128, "out_channels": 256, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 256 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 256, "out_channels": 512, "groups": 1, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 512 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 512, "out_channels": 1024, "groups": 4, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 1024 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 1024, "out_channels": 2048, "groups": 8, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 2048 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 2048, "out_channels": 4096, "groups": 32, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 4096 } ],
                [ "dropout", { "p": 0.3 } ],
                [ "relu", {} ]
            ]
        }
    },
    "head_params": {
        "ff_dim": 64,
        "num_hidden_layers": 1,
        "dropout_p": 0.2,
        "reduction_method": "mean"
    },
    "data_module_params": {
        "name": "text-classification",
        "params": {
            "data_path": "datasets/aclImdb",
            "max_len": 4096,
            "batch_size": 64,
            "pin_memory": true,
            "num_workers": 4
        }
    },
    "optimizer_params": {
        "lr": 1e-4,
        "betas": [ 0.9, 0.999 ],
        "weight_decay": 1e-3
    },
    "trainer_params": {
        "max_epochs": 40,
        "precision": "16-mixed",
        "enable_checkpointing": true,
        "default_root_dir": "out/text_classification/conv",
        "accelerator": "gpu",
        "devices": [ 2 ]
    },
    "fit_params": {}
}