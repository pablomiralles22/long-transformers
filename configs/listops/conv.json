{
    "model_params": {
        "name": "layered",
        "params": {
            "input_embedding_dim": 16,
            "output_embedding_dim": 4096,
            "layers": [
                [ "conv", { "in_channels": 16, "out_channels": 64, "kernel_size": 5} ],
                [ "mean_pool", { "kernel_size": 4, "stride": 4 } ],
                [ "layer_norm", { "normalized_shape": 64 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 64, "out_channels": 128, "kernel_size": 5} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 128 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 128, "out_channels": 256, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 256 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 256, "out_channels": 512, "groups": 1, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 512 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 512, "out_channels": 1024, "groups": 4, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 1024 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 1024, "out_channels": 2048, "groups": 8, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 2048 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ],

                [ "conv", { "in_channels": 2048, "out_channels": 4096, "groups": 32, "kernel_size": 3} ],
                [ "mean_pool", { "kernel_size": 2, "stride": 2 } ],
                [ "layer_norm", { "normalized_shape": 4096 } ],
                [ "dropout", { "p": 0.1 } ],
                [ "relu", {} ]
            ]
        }
    },
    "head_params": {
        "ff_dim": 256,
        "num_hidden_layers": 2,
        "dropout_p": 0.1,
        "reduction_method": "mean"
    },
    "data_module_params": {
        "name": "listops",
        "params": {
          "data_path": "datasets/lra_release/listops-1000",
          "max_len": 2000,
          "batch_size": 64,
          "pin_memory": true,
          "num_workers": 4
        }
      },
    "optimizer_params": {
        "lr": 1e-3,
        "betas": [ 0.9, 0.98 ]
    },
    "trainer_params": {
        "max_epochs": 40,
        "precision": "16-mixed",
        "enable_checkpointing": true,
        "default_root_dir": "out/listops/conv",
        "accelerator": "gpu",
        "devices": [ 1 ]
    },
    "fit_params": {}
}